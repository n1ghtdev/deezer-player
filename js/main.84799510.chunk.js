(window.webpackJsonp=window.webpackJsonp||[]).push([[0],Array(19).concat([function(e,t,a){e.exports=a(48)},,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),i=a(11),o=a(2),l=a(5),u=a(18),s=a(12);!function(e){e.PLAYLIST_REQUEST="@@playlist/request",e.PLAYLIST_SUCCESS="@@playlist/success",e.PLAYLIST_FAILURE="@@playlist/failure",e.PREV_SONG="@@playlist/prev-song",e.NEXT_SONG="@@playlist/next-song"}(n||(n={}));var d,f={list:[],loading:!1,error:!1};!function(e){e.PLAY="@@player/play",e.PAUSE="@@player/pause",e.INIT="@@player/init",e.SET_SONG_REQUEST="@@player/set-song-request",e.SET_SONG_SUCCESS="@@player/set-song-success",e.CHANGE_VOLUME="@@player/change-volume"}(d||(d={}));var m={pausedAt:0,state:"loading",duration:0,currentSong:null,volume:50,autoplay:!1};var p=Object(l.c)({playlist:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;return Object(s.a)(e,(function(e){switch(t.type){case n.PLAYLIST_REQUEST:e.loading=!0;break;case n.PLAYLIST_SUCCESS:e.list=t.payload,e.loading=!1,e.error=!1;break;case n.PLAYLIST_FAILURE:e.loading=!1,e.error=t.error}}))},player:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0,a=e.state;return Object(s.a)(e,(function(n){switch(t.type){case d.PLAY:n.state="playing";break;case d.PAUSE:n.pausedAt=t.payload.pausedAt,n.state="paused";break;case d.INIT:n.state="loading",n.currentSong=t.payload.currentSong,n.pausedAt=t.payload.pausedAt,n.duration=t.payload.duration;break;case d.SET_SONG_REQUEST:"playing"===a&&(n.autoplay=!0),n.pausedAt=0,n.currentSong=t.payload.songId,n.state="loading";break;case d.SET_SONG_SUCCESS:n.duration=t.payload,n.state=e.autoplay?"playing":"loaded";break;case d.CHANGE_VOLUME:n.volume=t.payload}}))}});var v=a(6),y=a.n(v),g=a(8),E="https://deezerdevs-deezer.p.rapidapi.com",h={"x-rapidapi-host":"deezerdevs-deezer.p.rapidapi.com","x-rapidapi-key":"4bHgyOZGbfmshQy4RRvk8yltlP36p1SuZuRjsnus3KfQYCfg1N"};function b(e){return S.apply(this,arguments)}function S(){return(S=Object(g.a)(y.a.mark((function e(t){var a,n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(E,"/search?q=").concat(t),e.next=3,fetch(a,{method:"get",headers:h});case 3:return n=e.sent,e.next=6,n.json();case 6:if(r=e.sent,!n.ok){e.next=9;break}return e.abrupt("return",r);case 9:throw new Error(r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e){var t=e.pausedAt;return{type:d.PAUSE,payload:{pausedAt:t}}}function _(e){return{type:d.SET_SONG_REQUEST,payload:{songId:e}}}function C(e){return{type:n.PLAYLIST_SUCCESS,payload:e}}function w(e){return{type:n.PLAYLIST_FAILURE,error:e}}function A(e){if(e.playlist.list&&e.player)return e.playlist.list.find((function(t){return t.id===e.player.currentSong}))}var k=a(9),O=a(3);function L(){var e=Object(o.b)();return{loadCache:c.a.useCallback((function(){try{var t=localStorage.getItem("audio-player"),a=JSON.parse(t),n=a.playlist,r=a.player;e(C(n)),e((c=r,{type:d.INIT,payload:c}))}catch(e){console.error(e)}var c}),[e]),saveCache:c.a.useCallback((function(e,t){if(e.list&&t.currentSong)try{localStorage.setItem("audio-player",JSON.stringify({playlist:e.list,player:t}))}catch(e){console.error(e)}}),[])}}a(32);function x(e){var t=e.children;return c.a.createElement("div",{className:"container"},t)}a(33);function T(e){var t=e.content,a=e.aside;return c.a.createElement("div",{className:"layout"},c.a.createElement("div",{className:"layout_content"},t),c.a.createElement("div",{className:"layout_aside"},a))}a(34);function R(e){var t=e.title,a=e.searchBar;return c.a.createElement("div",{className:"header"},c.a.createElement("h1",{className:"header_title"},t),a)}var P=a(7),j=a(4);a(35);function I(e){var t=e.onSubmit,a=c.a.useState(""),n=Object(P.a)(a,2),r=n[0],i=n[1];return c.a.createElement("form",{className:"search-bar_form",onSubmit:function(e){e.preventDefault(),t(r)}},c.a.createElement("input",{className:"search-bar_input",type:"text",value:r,onChange:function(e){var t=e.target;i(t.value)},placeholder:"Search"}),c.a.createElement("button",{className:"search-bar_button",type:"submit"},c.a.createElement(j.a,{icon:"search"})))}function U(e){function t(e){return e.toString().padStart(2,"0")}var a=Math.floor(e/60),n=e%60;return"".concat(t(a),":").concat(t(n))}a(36);function F(e){var t=e.playing;return c.a.createElement("svg",{className:"icon-playing ".concat(t?"active":""),viewBox:"0 0 18 17",width:"18",height:"17"},c.a.createElement("rect",{className:"icon-playing_bar icon-playing_bar-1",width:3,height:9,x:1,y:8}),c.a.createElement("rect",{className:"icon-playing_bar icon-playing_bar-2",width:3,height:14,x:5,y:3}),c.a.createElement("rect",{className:"icon-playing_bar icon-playing_bar-3",width:3,height:10,x:9,y:7}),c.a.createElement("rect",{className:"icon-playing_bar icon-playing_bar-4",width:3,height:6,x:13,y:11}))}a(37);function G(e){var t=e.title,a=e.duration,n=e.index,r=e.id,i=e.active,l=e.onChangeSong,u=Object(o.c)((function(e){return"playing"===e.player.state}));return c.a.createElement("div",{className:"song-item ".concat(i?"active":""),onClick:function(){i||l(r)}},c.a.createElement("span",{className:"song-item_number"},i?c.a.createElement(F,{playing:u}):n),c.a.createElement("span",{className:"song-item_name"},t),c.a.createElement("span",{className:"song-item_duration"},U(a)))}a(38);function Y(e){var t=e.songlist,a=e.currentSong,n=Object(o.b)(),r=c.a.useCallback((function(e){n(_(e))}),[n]);return c.a.createElement("div",{className:"song-list"},t.length>0?t.map((function(e,t){return c.a.createElement(G,{id:e.id,key:e.id,index:t+1,title:e.title_short,duration:e.duration,active:e.id===a,onChangeSong:r})})):c.a.createElement("div",{style:{padding:"25px"}},"No songs found"))}function M(e){var t,a=e.player.currentSong;if(a){var n=e.playlist.list.findIndex((function(e){return e.id===a}));if(0===n){var r=e.playlist.list.length-1;return e.playlist.list[r].id}return null===(t=e.playlist.list[n-1])||void 0===t?void 0:t.id}}function D(e){var t,a=e.player.currentSong;if(a){var n=e.playlist.list.findIndex((function(e){return e.id===a}));return n===e.playlist.list.length-1&&e.playlist.list[0]?e.playlist.list[0].id:null===(t=e.playlist.list[n+1])||void 0===t?void 0:t.id}}function V(e){return new Uint8Array(e).map((function(e){return Math.floor(126*Math.random())+50}))}function B(){var e,t,a=function(){AudioContext=window.AudioContext||window.webkitAudioContext;var e=new AudioContext,t=e.createAnalyser();return{context:e,analyser:t}}(),n=a.analyser,r=a.context,c=new Audio,i=r.createMediaElementSource(c);function o(e){c.currentTime=e}function l(){if(c.src)return c.currentTime}function u(){if(c.src)return c.duration}function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&t&&(d(e,a),f(t))}function d(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=a.getContext("2d");r?e=V(t):c.paused||(e=new Uint8Array(t),n.getByteFrequencyData(e));var o=0,l=Math.round(a.width/t);i.fillStyle="rgb(255,255,255)",i.fillRect(0,0,a.width,a.height);for(var u=0;u<t;u++){var s=e[u]/255*(a.height-25);c.duration/t*u<c.currentTime?(i.fillStyle="#97a9b2",i.fillRect(o,65,2,-s),i.fillStyle="#EDF0F2",i.fillRect(o,65,2,e[u]/255*25)):(i.fillStyle="#dee7eb",i.fillRect(o,65,2,-s)),o=l*u}}function f(e){if(e){var t=e.getContext("2d");t.clearRect(0,0,e.width,e.height),t.fillStyle="#EDF0F2",t.fillRect(0,0,e.width,e.height);var a=t.createLinearGradient(0,0,e.width,0);a.addColorStop(0,"#10b1dc"),a.addColorStop(1,"#2dd4c7"),t.fillStyle=a;var n=c.currentTime/c.duration*e.width||0;t.fillRect(0,0,n,e.height)}}return n.fftSize=1024,{audio:c,setSong:function(e){return c.preload="metadata",c.src=e,c.crossOrigin="anonymous",i.connect(n),n.connect(r.destination),function(){n.disconnect()}},play:function(){"suspended"===r.state&&r.resume().then((function(){console.log("Audio Context resumed")})),c.src&&c.play()},pause:function(){!c.paused&&c.src&&c.pause()},setPlayback:o,getPlayback:l,getDuration:u,changeVolume:function(e){c.volume=e},drawCanvas:function(e,a,n){function r(t){var n=this.getBoundingClientRect(),r=t.clientX-n.left,i=l(),s=u();o(r/this.width*s),0===i&&c.paused?(d(e,!0),f(a)):(d(e),f(a))}if(e&&a)return e.addEventListener("click",r),a.addEventListener("click",r),m=(i=e).getContext("2d"),i.width=i.offsetWidth,i.height=90,t=Math.round(i.width/3),m.clearRect(0,0,i.width,i.height),function(e){e.width=e.offsetWidth,e.height=8}(a),s(e,a,n),function(){e.removeEventListener("click",r),a.removeEventListener("click",r)};var i,m},drawFrame:s}}function Q(e,t,a){var n=Object(o.b)(),r=Object(o.c)((function(e){return e.player})),i=Object(o.c)(D),l=c.a.useRef(B()),u=c.a.useRef(null);c.a.useEffect((function(){if(e){var t=l.current.audio,a=l.current.setSong(e);return t.addEventListener("ended",c),t.addEventListener("loadedmetadata",o),function(){u.current&&(cancelAnimationFrame(u.current),u.current=null),a(),t.removeEventListener("ended",c),t.removeEventListener("loadedmetadata",o)}}function c(){n(_(i))}function o(){var e;0!==r.pausedAt&&l.current.audio.paused&&l.current.setPlayback(r.pausedAt),n((e=Math.round(l.current.getDuration()),{type:d.SET_SONG_SUCCESS,payload:e}))}}),[e,n,i]),c.a.useLayoutEffect((function(){var e=t.current,n=a.current;if(e&&n&&"loading"!==r.state){var c=l.current.drawCanvas(e,n,"loaded"===r.state);return function(){return c}}}),[t,a,r.state,e]),c.a.useEffect((function(){l.current.changeVolume(r.volume/100)}),[r.volume]);var s=c.a.useCallback((function(){var e=0;l.current.play(),e=Date.now(),function n(){u.current=requestAnimationFrame(n);var r=Date.now(),c=r-e;c>50&&(e=r-c%50,l.current.drawFrame(t.current,a.current))}()}),[a,t]),f=c.a.useCallback((function(){cancelAnimationFrame(u.current),l.current.pause()}),[]);return c.a.useEffect((function(){"paused"===r.state?f():"playing"===r.state&&s()}),[r.state,n,s,f,e]),{getCurrentTime:function(){return l.current.getPlayback()}}}a(39);function q(e){var t=e.canvasRef;return c.a.createElement("canvas",{className:"visualizer",ref:t,height:0})}a(40);function z(e){var t=e.onPlay,a=e.onPause,n=e.onPrev,r=e.onNext,i=e.isPlaying;return c.a.createElement("div",{className:"controls"},c.a.createElement("button",{className:"controls_button",onClick:n},c.a.createElement(j.a,{icon:"backward"})),i?c.a.createElement("button",{className:"controls_button",onClick:a},c.a.createElement(j.a,{icon:"pause"})):c.a.createElement("button",{className:"controls_button",onClick:t},c.a.createElement(j.a,{icon:"play"})),c.a.createElement("button",{className:"controls_button",onClick:r},c.a.createElement(j.a,{icon:"forward"})))}a(41);function H(e){var t=e.poster,a=e.title,n=e.artist;return c.a.createElement("div",{className:"info"},c.a.createElement("img",{className:"info_poster",src:t,alt:"".concat(n," - ").concat(a)}),c.a.createElement("div",{className:"info_header"},c.a.createElement("h2",{className:"info_title"},a),c.a.createElement("h3",{className:"info_artist"},n)))}a(42);function J(e){var t=e.volume,a=e.onVolumeChange,n=c.a.useState(0),r=Object(P.a)(n,2),i=r[0],o=r[1],l={100:"volume-up",50:"volume-down",25:"volume-off",0:"volume-mute"};return c.a.createElement("div",{className:"volume"},c.a.createElement(j.a,{onClick:function(){0!==t?(o(t),a(0)):a(i)},className:"volume_icon",icon:function(e){return l[Object.keys(l).find((function(t){return Number(t)>=e}))]}(t)}),c.a.createElement("input",{className:"volume_slider",type:"range",value:t,onChange:function(e){var t=e.target;a(Number(t.value))},min:0,max:100}))}a(43);function W(e){var t=e.posterSrc,a=e.posterAlt,n=e.children;return c.a.createElement("div",{className:"player_hero"},c.a.createElement("div",{className:"player_poster"},c.a.createElement("img",{src:t,alt:a})),c.a.createElement("div",{className:"player_hero-content"},n))}a(44);function X(e){var t=e.getCurrentTime,a=Object(o.c)((function(e){return e.player})),n=c.a.useState(0),r=Object(P.a)(n,2),i=r[0],l=r[1],u=c.a.useRef(null);return c.a.useEffect((function(){var e=0;return"loading"!==a.state&&(e=Date.now(),function a(){u.current=requestAnimationFrame(a);var n=Date.now(),r=n-e;r>200&&(e=n-r%200,l(Math.round(t())))}()),function(){u.current&&cancelAnimationFrame(u.current)}}),[a.state,a.pausedAt,t]),c.a.createElement("div",{className:"player_time"},c.a.createElement("div",{className:"player_time-current"},U(i)),c.a.createElement("div",{className:"player_time-duration"},U(a.duration)))}a(45);function Z(e){var t=e.progressBarRef,a=e.children;return c.a.createElement("div",{className:"player-bar"},c.a.createElement("canvas",{height:0,ref:t,className:"player-bar_progressbar"}),c.a.createElement("div",{className:"player-bar_content"},a))}a(46);function K(e){var t=e.song,a=c.a.useRef(null),n=c.a.useRef(null),r=Q(null===t||void 0===t?void 0:t.preview,a,n).getCurrentTime,i=Object(o.b)(),l=Object(o.c)((function(e){return e.player})),u=Object(o.c)(M),s=Object(o.c)(D),f=c.a.useCallback((function(){i({type:d.PLAY})}),[i]),m=c.a.useCallback((function(){i(N({pausedAt:r()}))}),[i,r]),p=c.a.useCallback((function(){i(_(u))}),[i,u]),v=c.a.useCallback((function(){i(_(s))}),[i,s]),y=c.a.useCallback((function(e){i(function(e){return{type:d.CHANGE_VOLUME,payload:e}}(e))}),[i]);return t?c.a.createElement("div",{className:"player"},c.a.createElement(W,{posterSrc:t.album.cover_medium,posterAlt:t.title},c.a.createElement(X,{getCurrentTime:function(){return r()}}),c.a.createElement(q,{canvasRef:a})),c.a.createElement(Z,{progressBarRef:n},c.a.createElement(z,{onPlay:f,onPause:m,onPrev:p,onNext:v,isPlaying:"playing"===l.state}),c.a.createElement(H,{poster:t.album.cover_medium,title:t.title,artist:t.artist.name}),c.a.createElement(J,{onVolumeChange:y,volume:l.volume}))):c.a.createElement("div",{className:"player"})}k.b.add(O.a,O.b,O.d,O.f,O.h,O.i,O.g,O.e,O.c);a(47);var $,ee,te,ae=($=l.d,ee=[u.a],te=[l.a.apply(void 0,ee)],Object(l.e)(p,$.apply(void 0,te))),ne=document.getElementById("root");Object(i.render)(c.a.createElement(o.a,{store:ae},c.a.createElement((function(){var e=Object(o.c)((function(e){return e.playlist})),t=Object(o.c)((function(e){return e.player})),a=Object(o.c)(A),r=Object(o.b)(),i=L(),l=i.loadCache,u=i.saveCache;return c.a.useEffect((function(){l()}),[l]),c.a.useEffect((function(){u(e,t)}),[e,t,u]),c.a.createElement(x,null,c.a.createElement(R,{title:"Visage",searchBar:c.a.createElement(I,{onSubmit:function(e){r(function(e){return function(){var t=Object(g.a)(y.a.mark((function t(a){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:n.PLAYLIST_REQUEST}),b(e).then((function(e){0!==e.data.total&&(a(C(e.data)),a(N({pausedAt:0})),a(_(e.data[0].id)))}),(function(e){a(w(e))}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(e))}})}),c.a.createElement(T,{content:c.a.createElement(K,{song:a}),aside:c.a.createElement(Y,{songlist:e.list,currentSong:null===a||void 0===a?void 0:a.id})}))}),null)),ne)}]),[[19,1,2]]]);
//# sourceMappingURL=main.84799510.chunk.js.map